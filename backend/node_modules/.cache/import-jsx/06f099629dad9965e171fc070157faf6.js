"use strict";

const React = require("react"),
      {
  useApp,
  Static,
  Box,
  Text,
  Newline
} = require("ink"),
      SelectInput = require("ink-select-input").default,
      Spinner = require("ink-spinner").default,
      open = require("open"),
      uuid = require("uuid").v4,
      EventSource = require("eventsource"),
      fetch = require("node-fetch"),
      config = require("../config").global,
      ItemComponent = ({
  isSelected: b = !1,
  label: a
}) => /*#__PURE__*/React.createElement(Text, {
  color: b ? "cyan" : void 0
}, a),
      Loading = ({
  status: a,
  showSpinner: b = !0
  /* enable colors */

  /* enable colors */

  /* enable colors */

  /* enable colors */

}) => /*#__PURE__*/React.createElement(Text, null, b ? /*#__PURE__*/React.createElement(Text, {
  color: "green"
}, /*#__PURE__*/React.createElement(Spinner, {
  type: "dots"
})) : null, b ? ` ${a}` : `${a}`),
      fronti_url = `${process.env.ADMIN_URL || "https://auth.codehooks.io"}`,
      fronti_api_url = `${process.env.ADMIN_API_URL || "https://admin.codehooks.io"}`,
      items = [{
  label: "Use Github",
  value: "github",
  url: `${fronti_url}/authenticate/github`
}, {
  label: "Use Google",
  value: "google",
  url: `${fronti_url}/authenticate/google`
}, {
  label: "Exit",
  value: "exit"
}],
      authStatus = {
  INITIAL: 0,
  WAITING: 1,
  SUCCESS: 2,
  FAILED: 3,
  TIMEOUT: 4
},
      Menu = ({
  provider: a
}) => {
  const [b, c] = React.useState(authStatus.INITIAL),
        [d, e] = React.useState(null),
        [f, g] = React.useState([]),
        [h, i] = React.useState(""),
        [j, k] = React.useState(null),
        {
    exit: l
  } = useApp();
  React.useEffect(() => {
    if (j && j.url) {
      const a = uuid(),
            b = `${j.url}/${a}`;
      c(authStatus.WAITING), g([`If browser does not open automatically, please paste in this URL in a new browser tab/window: ${b}`, ...f]), i(`Authenticating with ${j.value}`);

      (async () => {
        open(b);

        try {
          const b = new EventSource(`${fronti_api_url}/cli_auth/${a}`);

          b.onmessage = a => {
            try {
              const b = JSON.parse(a.data); // store token in configstore

              config.set("token", b.token), c(authStatus.SUCCESS);
            } catch (a) {
              c(authStatus.FAILED), i(`Authenticating with ${j.value} failed. Please try again.`);
            }
          };
        } catch (a) {
          c(authStatus.FAILED), i(`Authenticating with ${j.value} failed. Please try again.`);
        }
      })();
    }
  }, [j]), React.useEffect(() => {
    if (b === authStatus.SUCCESS) {
      (async () => {
        const a = {
          method: "post",
          body: JSON.stringify({
            query: "{ currentUser {id name termsAccepted} }",
            variables: {}
          }),
          headers: {
            "Content-Type": "application/json",
            Authorization: `Bearer ${config.get("token")}`
          },
          redirect: "follow"
        };

        try {
          const b = await fetch(`${fronti_api_url}/graphql`, a);

          if (200 === b.status) {
            const a = await b.json();
            e(a && a.data && a.data.currentUser || {
              name: "thanks"
            });
          } else ;
        } catch (a) {//console.error(err);
        }
      })();
    }
  }, [b]);

  const m = a => a && "exit" === a.value ? l() : void k(a);

  if (b === authStatus.INITIAL && a) {
    c(authStatus.WAITING);
    const b = items && items.find(b => b.value === a && b.url);
    b ? m(b) : (console.log("Unknown authentication provider"), l());
  }

  return d && b === authStatus.SUCCESS ? (setTimeout(() => {
    process.exit();
  }, 300), /*#__PURE__*/React.createElement(Box, {
    flexDirection: "column",
    marginTop: 1
  }, /*#__PURE__*/React.createElement(Text, null, `ðŸ‘ Authentication complete, ${d.name}!`, " "), /*#__PURE__*/React.createElement(Text, null, "You are now ready to use the Codehooks CLI. Please close the browser window. "), !d.termsAccepted && /*#__PURE__*/React.createElement(Box, {
    marginTop: 1
  }, /*#__PURE__*/React.createElement(Text, null, "\uD83D\uDCDD Remember to use the command 'coho account' to accept our terms first!")))) : /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Static, {
    items: f
  }, (a, b) => /*#__PURE__*/React.createElement(Box, {
    key: b
  }, /*#__PURE__*/React.createElement(Text, null, a))), /*#__PURE__*/React.createElement(Newline, null), b === authStatus.WAITING ? /*#__PURE__*/React.createElement(Loading, {
    status: h
  }) : null, b !== authStatus.INITIAL || a ? null : /*#__PURE__*/React.createElement(Box, {
    flexDirection: "column"
  }, /*#__PURE__*/React.createElement(Box, {
    marginBottom: 1
  }, /*#__PURE__*/React.createElement(Text, null, "Select option below")), /*#__PURE__*/React.createElement(SelectInput, {
    itemComponent: ItemComponent,
    items: items,
    onSelect: m
  })), b === authStatus.TIMEOUT ? /*#__PURE__*/React.createElement(Loading, {
    status: h,
    showSpinner: !1
  }) : null);
};

module.exports = Menu;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkxvZ2luTWVudS5qcyJdLCJuYW1lcyI6WyJSZWFjdCIsInJlcXVpcmUiLCJ1c2VBcHAiLCJTdGF0aWMiLCJCb3giLCJUZXh0IiwiTmV3bGluZSIsIlNlbGVjdElucHV0IiwiZGVmYXVsdCIsIlNwaW5uZXIiLCJvcGVuIiwidXVpZCIsInY0IiwiRXZlbnRTb3VyY2UiLCJmZXRjaCIsImNvbmZpZyIsImdsb2JhbCIsIkl0ZW1Db21wb25lbnQiLCJpc1NlbGVjdGVkIiwiYiIsImxhYmVsIiwiYSIsIkxvYWRpbmciLCJzdGF0dXMiLCJzaG93U3Bpbm5lciIsImZyb250aV91cmwiLCJwcm9jZXNzIiwiZW52IiwiQURNSU5fVVJMIiwiZnJvbnRpX2FwaV91cmwiLCJBRE1JTl9BUElfVVJMIiwiaXRlbXMiLCJ2YWx1ZSIsInVybCIsImF1dGhTdGF0dXMiLCJJTklUSUFMIiwiV0FJVElORyIsIlNVQ0NFU1MiLCJGQUlMRUQiLCJUSU1FT1VUIiwiTWVudSIsInByb3ZpZGVyIiwiYyIsInVzZVN0YXRlIiwiZCIsImUiLCJmIiwiZyIsImgiLCJpIiwiaiIsImsiLCJleGl0IiwibCIsInVzZUVmZmVjdCIsIm9ubWVzc2FnZSIsIkpTT04iLCJwYXJzZSIsImRhdGEiLCJzZXQiLCJ0b2tlbiIsIm1ldGhvZCIsImJvZHkiLCJzdHJpbmdpZnkiLCJxdWVyeSIsInZhcmlhYmxlcyIsImhlYWRlcnMiLCJBdXRob3JpemF0aW9uIiwiZ2V0IiwicmVkaXJlY3QiLCJqc29uIiwiY3VycmVudFVzZXIiLCJuYW1lIiwibSIsImZpbmQiLCJjb25zb2xlIiwibG9nIiwic2V0VGltZW91dCIsInRlcm1zQWNjZXB0ZWQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFBYSxNQUFNQSxLQUFLLEdBQUNDLE9BQU8sQ0FBQyxPQUFELENBQW5CO0FBQUEsTUFBNkI7QUFBQ0MsRUFBQUEsTUFBRDtBQUFRQyxFQUFBQSxNQUFSO0FBQWVDLEVBQUFBLEdBQWY7QUFBbUJDLEVB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LEVBQUUwQztBQUFqRSxJQUo0QixDQVJ4QixFQWNQdEQsQ0FBQyxLQUFHZSxVQUFVLENBQUNLLE9BQWYsZ0JBQXVCLG9CQUFDLE9BQUQ7QUFBUyxJQUFBLE1BQU0sRUFBRVMsQ0FBakI7QUFBbUIsSUFBQSxXQUFXLEVBQUUsQ0FBQztBQUFqQyxJQUF2QixHQUFzRSxJQWQvRCxDQUoyTTtBQW1Cbk4sQ0ExQks7O0FBMEJKK0IsTUFBTSxDQUFDQyxPQUFQLEdBQWV4QyxJQUFmIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7Y29uc3QgUmVhY3Q9cmVxdWlyZShcInJlYWN0XCIpLHt1c2VBcHAsU3RhdGljLEJveCxUZXh0LE5ld2xpbmV9PXJlcXVpcmUoXCJpbmtcIiksU2VsZWN0SW5wdXQ9cmVxdWlyZShcImluay1zZWxlY3QtaW5wdXRcIikuZGVmYXVsdCxTcGlubmVyPXJlcXVpcmUoXCJpbmstc3Bpbm5lclwiKS5kZWZhdWx0LG9wZW49cmVxdWlyZShcIm9wZW5cIiksdXVpZD1yZXF1aXJlKFwidXVpZFwiKS52NCxFdmVudFNvdXJjZT1yZXF1aXJlKFwiZXZlbnRzb3VyY2VcIiksZmV0Y2g9cmVxdWlyZShcIm5vZGUtZmV0Y2hcIiksY29uZmlnPXJlcXVpcmUoXCIuLi9jb25maWdcIikuZ2xvYmFsLEl0ZW1Db21wb25lbnQ9KHtpc1NlbGVjdGVkOmI9ITEsbGFiZWw6YX0pPT48VGV4dCBjb2xvcj17Yj9cImN5YW5cIjp2b2lkIDB9PnthfTwvVGV4dD4sTG9hZGluZz0oe3N0YXR1czphLHNob3dTcGlubmVyOmI9ITAvKiBlbmFibGUgY29sb3JzICovIC8qIGVuYWJsZSBjb2xvcnMgKi8gLyogZW5hYmxlIGNvbG9ycyAqLyAvKiBlbmFibGUgY29sb3JzICovfSk9PjxUZXh0PlxuXHRcdHtiPzxUZXh0IGNvbG9yPVwiZ3JlZW5cIj5cblx0XHRcdDxTcGlubmVyIHR5cGU9XCJkb3RzXCIvPlxuXHRcdDwvVGV4dD46bnVsbH1cblx0XHR7Yj9gICR7YX1gOmAke2F9YH1cblx0PC9UZXh0Pixmcm9udGlfdXJsPWAke3Byb2Nlc3MuZW52LkFETUlOX1VSTHx8XCJodHRwczovL2F1dGguY29kZWhvb2tzLmlvXCJ9YCxmcm9udGlfYXBpX3VybD1gJHtwcm9jZXNzLmVudi5BRE1JTl9BUElfVVJMfHxcImh0dHBzOi8vYWRtaW4uY29kZWhvb2tzLmlvXCJ9YCxpdGVtcz1be2xhYmVsOlwiVXNlIEdpdGh1YlwiLHZhbHVlOlwiZ2l0aHViXCIsdXJsOmAke2Zyb250aV91cmx9L2F1dGhlbnRpY2F0ZS9naXRodWJgfSx7bGFiZWw6XCJVc2UgR29vZ2xlXCIsdmFsdWU6XCJnb29nbGVcIix1cmw6YCR7ZnJvbnRpX3VybH0vYXV0aGVudGljYXRlL2dvb2dsZWB9LHtsYWJlbDpcIkV4aXRcIix2YWx1ZTpcImV4aXRcIn1dLGF1dGhTdGF0dXM9e0lOSVRJQUw6MCxXQUlUSU5HOjEsU1VDQ0VTUzoyLEZBSUxFRDozLFRJTUVPVVQ6NH0sTWVudT0oe3Byb3ZpZGVyOmF9KT0+e2NvbnN0W2IsY109UmVhY3QudXNlU3RhdGUoYXV0aFN0YXR1cy5JTklUSUFMKSxbZCxlXT1SZWFjdC51c2VTdGF0ZShudWxsKSxbZixnXT1SZWFjdC51c2VTdGF0ZShbXSksW2gsaV09UmVhY3QudXNlU3RhdGUoXCJcIiksW2osa109UmVhY3QudXNlU3RhdGUobnVsbCkse2V4aXQ6bH09dXNlQXBwKCk7UmVhY3QudXNlRWZmZWN0KCgpPT57aWYoaiYmai51cmwpe2NvbnN0IGE9dXVpZCgpLGI9YCR7ai51cmx9LyR7YX1gO2MoYXV0aFN0YXR1cy5XQUlUSU5HKSxnKFtgSWYgYnJvd3NlciBkb2VzIG5vdCBvcGVuIGF1dG9tYXRpY2FsbHksIHBsZWFzZSBwYXN0ZSBpbiB0aGlzIFVSTCBpbiBhIG5ldyBicm93c2VyIHRhYi93aW5kb3c6ICR7Yn1gLC4uLmZdKSxpKGBBdXRoZW50aWNhdGluZyB3aXRoICR7ai52YWx1ZX1gKTsoYXN5bmMoKT0+e29wZW4oYik7dHJ5e2NvbnN0IGI9bmV3IEV2ZW50U291cmNlKGAke2Zyb250aV9hcGlfdXJsfS9jbGlfYXV0aC8ke2F9YCk7Yi5vbm1lc3NhZ2U9YT0+e3RyeXtjb25zdCBiPUpTT04ucGFyc2UoYS5kYXRhKTsvLyBzdG9yZSB0b2tlbiBpbiBjb25maWdzdG9yZVxuY29uZmlnLnNldChcInRva2VuXCIsYi50b2tlbiksYyhhdXRoU3RhdHVzLlNVQ0NFU1MpfWNhdGNoKGEpe2MoYXV0aFN0YXR1cy5GQUlMRUQpLGkoYEF1dGhlbnRpY2F0aW5nIHdpdGggJHtqLnZhbHVlfSBmYWlsZWQuIFBsZWFzZSB0cnkgYWdhaW4uYCl9fX1jYXRjaChhKXtjKGF1dGhTdGF0dXMuRkFJTEVEKSxpKGBBdXRoZW50aWNhdGluZyB3aXRoICR7ai52YWx1ZX0gZmFpbGVkLiBQbGVhc2UgdHJ5IGFnYWluLmApfX0pKCl9fSxbal0pLFJlYWN0LnVzZUVmZmVjdCgoKT0+e2lmKGI9PT1hdXRoU3RhdHVzLlNVQ0NFU1Mpeyhhc3luYygpPT57Y29uc3QgYT17bWV0aG9kOlwicG9zdFwiLGJvZHk6SlNPTi5zdHJpbmdpZnkoe3F1ZXJ5OlwieyBjdXJyZW50VXNlciB7aWQgbmFtZSB0ZXJtc0FjY2VwdGVkfSB9XCIsdmFyaWFibGVzOnt9fSksaGVhZGVyczp7XCJDb250ZW50LVR5cGVcIjpcImFwcGxpY2F0aW9uL2pzb25cIixBdXRob3JpemF0aW9uOmBCZWFyZXIgJHtjb25maWcuZ2V0KFwidG9rZW5cIil9YH0scmVkaXJlY3Q6XCJmb2xsb3dcIn07dHJ5e2NvbnN0IGI9YXdhaXQgZmV0Y2goYCR7ZnJvbnRpX2FwaV91cmx9L2dyYXBocWxgLGEpO2lmKDIwMD09PWIuc3RhdHVzKXtjb25zdCBhPWF3YWl0IGIuanNvbigpO2UoYSYmYS5kYXRhJiZhLmRhdGEuY3VycmVudFVzZXJ8fHtuYW1lOlwidGhhbmtzXCJ9KX1lbHNlO31jYXRjaChhKXsvL2NvbnNvbGUuZXJyb3IoZXJyKTtcbn19KSgpfX0sW2JdKTtjb25zdCBtPWE9PmEmJlwiZXhpdFwiPT09YS52YWx1ZT9sKCk6dm9pZCBrKGEpO2lmKGI9PT1hdXRoU3RhdHVzLklOSVRJQUwmJmEpe2MoYXV0aFN0YXR1cy5XQUlUSU5HKTtjb25zdCBiPWl0ZW1zJiZpdGVtcy5maW5kKGI9PmIudmFsdWU9PT1hJiZiLnVybCk7Yj9tKGIpOihjb25zb2xlLmxvZyhcIlVua25vd24gYXV0aGVudGljYXRpb24gcHJvdmlkZXJcIiksbCgpKX1yZXR1cm4gZCYmYj09PWF1dGhTdGF0dXMuU1VDQ0VTUz8oc2V0VGltZW91dCgoKT0+e3Byb2Nlc3MuZXhpdCgpfSwzMDApLDxCb3ggZmxleERpcmVjdGlvbj1cImNvbHVtblwibWFyZ2luVG9wPXsxfT5cbiAgICAgICAgICAgIDxUZXh0Pntg8J+RjyBBdXRoZW50aWNhdGlvbiBjb21wbGV0ZSwgJHtkLm5hbWV9IWB9IDwvVGV4dD5cbiAgICAgICAgICAgIDxUZXh0PllvdSBhcmUgbm93IHJlYWR5IHRvIHVzZSB0aGUgQ29kZWhvb2tzIENMSS4gUGxlYXNlIGNsb3NlIHRoZSBicm93c2VyIHdpbmRvdy4gPC9UZXh0PlxuICAgICAgICAgICAgeyFkLnRlcm1zQWNjZXB0ZWQmJjxCb3ggbWFyZ2luVG9wPXsxfT48VGV4dD7wn5OdIFJlbWVtYmVyIHRvIHVzZSB0aGUgY29tbWFuZCAnY29obyBhY2NvdW50JyB0byBhY2NlcHQgb3VyIHRlcm1zIGZpcnN0ITwvVGV4dD48L0JveD59XG4gICAgICAgIDwvQm94Pik6PD5cbiAgICAgICAgPFN0YXRpYyBpdGVtcz17Zn0+XG4gICAgICAgICAgICB7KGEsYik9PjxCb3gga2V5PXtifT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxUZXh0PnthfTwvVGV4dD5cbiAgICAgICAgICAgICAgICAgICAgPC9Cb3g+fVxuICAgICAgICA8L1N0YXRpYz5cbiAgICAgICAgPE5ld2xpbmUvPlxuICAgICAgICB7Yj09PWF1dGhTdGF0dXMuV0FJVElORz88TG9hZGluZyBzdGF0dXM9e2h9PjwvTG9hZGluZz46bnVsbH1cbiAgICAgICAge2IhPT1hdXRoU3RhdHVzLklOSVRJQUx8fGE/bnVsbDo8Qm94IGZsZXhEaXJlY3Rpb249XCJjb2x1bW5cIj5cbiAgICAgICAgICAgIDxCb3ggbWFyZ2luQm90dG9tPXsxfT5cbiAgICAgICAgICAgICAgICA8VGV4dD5TZWxlY3Qgb3B0aW9uIGJlbG93PC9UZXh0PlxuICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICA8U2VsZWN0SW5wdXQgaXRlbUNvbXBvbmVudD17SXRlbUNvbXBvbmVudH1pdGVtcz17aXRlbXN9b25TZWxlY3Q9e219Lz5cbiAgICAgICAgPC9Cb3g+fVxuICAgICAgICB7Yj09PWF1dGhTdGF0dXMuVElNRU9VVD88TG9hZGluZyBzdGF0dXM9e2h9c2hvd1NwaW5uZXI9eyExfT48L0xvYWRpbmc+Om51bGx9XG4gICAgPC8+fTttb2R1bGUuZXhwb3J0cz1NZW51OyJdfQ==